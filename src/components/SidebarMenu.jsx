// SidebarMenu.jsx
import React, { useEffect, useState } from "react";
import { Link, useLocation, useNavigate } from "react-router-dom";
import "./SidebarMenu.css";

const menuItems = [
  { path: "/", label: "Головна", icon: "🏵️" },
  { path: "/calendar", label: "Календар", icon: "📅" },
  { path: "/notes", label: "Нотатник", icon: "📄" },
  { path: "/tamagotchi", label: "Тамагочі", icon: "🐾" },
  { path: "/selfhelp", label: "Селфхелп", icon: "ℹ️" },
];

const SidebarMenu = () => {
  const location = useLocation();
  const navigate = useNavigate();
  const [user, setUser] = useState(null);
    
   useEffect(() => {
      const storedUser = localStorage.getItem("user");
      if (storedUser) {
        setUser(JSON.parse(storedUser));
      }
    }, []);
  
  const isAuthenticated = !!user;

  const handleLogout = () => {
    localStorage.clear();
    window.location.reload(); 
    navigate("/login");
  };

  return (
    <nav className="sidebar">
      <div className="logo">
        <svg width="185" height="25" viewBox="0 0 185 25" fill="none" xmlns="http://www.w3.org/2000/svg">
        <g clip-path="url(#clip0_7_85)">
        <path d="M5.40795 0.000270389C3.5925 0.00894901 1.78018 0.228313 0 0.72835C0.885707 1.52889 1.78938 2.3077 2.65003 3.13858C4.82025 5.20526 6.57366 7.88596 7.23595 10.9425C7.6786 12.9853 6.28098 17.1157 7.07161 19.43C8.87919 24.7209 14.246 25.7735 17.1243 24.5255C19.8838 23.3289 21.4977 20.5875 23 18.0723L24.6563 15.134C26.9594 11.2143 29.5486 7.2279 33.3372 4.76047C35.5139 3.34329 37.7075 3.12408 38.7342 3.1123C39.0764 3.10824 39.2888 3.12749 39.3278 3.13299C39.3278 3.13299 38.0385 4.65099 37.3912 6.03268C36.744 7.41437 36.009 9.35276 35.9477 11.4334C35.833 15.3273 37.7543 17.372 35.4235 20.4166C34.5232 21.5926 32.5828 22.3584 31.128 22.0795C28.133 21.5053 26.5285 18.6814 25.1414 16.0538L23.5929 19.0411C24.9433 21.2611 26.4678 23.4813 28.8757 24.5255C31.7539 25.7735 37.1208 24.7209 38.9284 19.43C39.719 17.1157 38.3214 12.9854 38.764 10.9425C39.4263 7.88597 41.1798 5.20527 43.35 3.13859C44.2106 2.30771 45.1143 1.5289 46 0.728361C43.1517 -0.0716927 40.221 -0.153106 37.3275 0.196839C35.0999 0.466256 32.9114 1.3789 31.0401 2.67504C27.2323 5.31237 25.5062 8.03843 23 12.2645L21.3437 15.134C19.8325 17.9812 18.2202 21.4376 14.872 22.0795C13.4172 22.3584 11.4768 21.5926 10.5765 20.4166C8.24569 17.372 10.167 15.3273 10.0523 11.4334C9.99103 9.35276 9.25599 7.41437 8.60877 6.03268C7.96154 4.65099 6.67221 3.13299 6.67221 3.13299C6.71123 3.12756 6.92362 3.10837 7.26583 3.1123C8.29245 3.1241 10.4861 3.34329 12.6628 4.76047C16.1267 7.01647 18.5847 10.5427 20.7414 14.1263L22.4515 11.3493C20.228 7.64367 18.4806 5.11348 14.9599 2.67503C13.0886 1.37889 10.9001 0.466246 8.67252 0.196829C7.58746 0.0656053 6.49723 -0.00495034 5.40795 0.000270389Z" fill="#FAF4E4"/>
        <path d="M23 8.13241C23.3676 5.98132 24.552 3.16443 26.2888 1.33679" stroke="#FAF4E4" stroke-width="5.29134" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M23 8.13241C22.6324 5.98132 21.4479 3.16443 19.7112 1.33679" stroke="#FAF4E4" stroke-width="5.29134" stroke-linecap="round" stroke-linejoin="round"/>
        </g>
        <path d="M54.9296 16.5V9.5H57.9596C58.5863 9.5 59.1263 9.60333 59.5796 9.81C60.0329 10.01 60.3829 10.3 60.6296 10.68C60.8763 11.06 60.9996 11.5133 60.9996 12.04C60.9996 12.56 60.8763 13.01 60.6296 13.39C60.3829 13.7633 60.0329 14.05 59.5796 14.25C59.1263 14.45 58.5863 14.55 57.9596 14.55H55.8296L56.5496 13.84V16.5H54.9296ZM59.3796 16.5L57.6296 13.96H59.3596L61.1296 16.5H59.3796ZM56.5496 14.02L55.8296 13.26H57.8696C58.3696 13.26 58.7429 13.1533 58.9896 12.94C59.2363 12.72 59.3596 12.42 59.3596 12.04C59.3596 11.6533 59.2363 11.3533 58.9896 11.14C58.7429 10.9267 58.3696 10.82 57.8696 10.82H55.8296L56.5496 10.05V14.02ZM68.7731 12.32H72.1431V13.58H68.7731V12.32ZM68.8931 15.2H72.7031V16.5H67.2831V9.5H72.5731V10.8H68.8931V15.2ZM81.2921 16.62C80.7321 16.62 80.1954 16.5467 79.6821 16.4C79.1688 16.2467 78.7554 16.05 78.4421 15.81L78.9921 14.59C79.2921 14.8033 79.6454 14.98 80.0521 15.12C80.4654 15.2533 80.8821 15.32 81.3021 15.32C81.6221 15.32 81.8788 15.29 82.0721 15.23C82.2721 15.1633 82.4188 15.0733 82.5121 14.96C82.6054 14.8467 82.6521 14.7167 82.6521 14.57C82.6521 14.3833 82.5788 14.2367 82.4321 14.13C82.2854 14.0167 82.0921 13.9267 81.8521 13.86C81.6121 13.7867 81.3454 13.72 81.0521 13.66C80.7654 13.5933 80.4754 13.5133 80.1821 13.42C79.8954 13.3267 79.6321 13.2067 79.3921 13.06C79.1521 12.9133 78.9554 12.72 78.8021 12.48C78.6554 12.24 78.5821 11.9333 78.5821 11.56C78.5821 11.16 78.6888 10.7967 78.9021 10.47C79.1221 10.1367 79.4488 9.87333 79.8821 9.68C80.3221 9.48 80.8721 9.38 81.5321 9.38C81.9721 9.38 82.4054 9.43333 82.8321 9.54C83.2588 9.64 83.6354 9.79333 83.9621 10L83.4621 11.23C83.1354 11.0433 82.8088 10.9067 82.4821 10.82C82.1554 10.7267 81.8354 10.68 81.5221 10.68C81.2088 10.68 80.9521 10.7167 80.7521 10.79C80.5521 10.8633 80.4088 10.96 80.3221 11.08C80.2354 11.1933 80.1921 11.3267 80.1921 11.48C80.1921 11.66 80.2654 11.8067 80.4121 11.92C80.5588 12.0267 80.7521 12.1133 80.9921 12.18C81.2321 12.2467 81.4954 12.3133 81.7821 12.38C82.0754 12.4467 82.3654 12.5233 82.6521 12.61C82.9454 12.6967 83.2121 12.8133 83.4521 12.96C83.6921 13.1067 83.8854 13.3 84.0321 13.54C84.1854 13.78 84.2621 14.0833 84.2621 14.45C84.2621 14.8433 84.1521 15.2033 83.9321 15.53C83.7121 15.8567 83.3821 16.12 82.9421 16.32C82.5088 16.52 81.9588 16.62 81.2921 16.62ZM93.7691 16.62C93.2157 16.62 92.7024 16.53 92.2291 16.35C91.7624 16.17 91.3557 15.9167 91.0091 15.59C90.6691 15.2633 90.4024 14.88 90.2091 14.44C90.0224 14 89.9291 13.52 89.9291 13C89.9291 12.48 90.0224 12 90.2091 11.56C90.4024 11.12 90.6724 10.7367 91.0191 10.41C91.3657 10.0833 91.7724 9.83 92.2391 9.65C92.7057 9.47 93.2124 9.38 93.7591 9.38C94.3124 9.38 94.8191 9.47 95.2791 9.65C95.7457 9.83 96.1491 10.0833 96.4891 10.41C96.8357 10.7367 97.1057 11.12 97.2991 11.56C97.4924 11.9933 97.5891 12.4733 97.5891 13C97.5891 13.52 97.4924 14.0033 97.2991 14.45C97.1057 14.89 96.8357 15.2733 96.4891 15.6C96.1491 15.92 95.7457 16.17 95.2791 16.35C94.8191 16.53 94.3157 16.62 93.7691 16.62ZM93.7591 15.24C94.0724 15.24 94.3591 15.1867 94.6191 15.08C94.8857 14.9733 95.1191 14.82 95.3191 14.62C95.5191 14.42 95.6724 14.1833 95.7791 13.91C95.8924 13.6367 95.9491 13.3333 95.9491 13C95.9491 12.6667 95.8924 12.3633 95.7791 12.09C95.6724 11.8167 95.5191 11.58 95.3191 11.38C95.1257 11.18 94.8957 11.0267 94.6291 10.92C94.3624 10.8133 94.0724 10.76 93.7591 10.76C93.4457 10.76 93.1557 10.8133 92.8891 10.92C92.6291 11.0267 92.3991 11.18 92.1991 11.38C91.9991 11.58 91.8424 11.8167 91.7291 12.09C91.6224 12.3633 91.5691 12.6667 91.5691 13C91.5691 13.3267 91.6224 13.63 91.7291 13.91C91.8424 14.1833 91.9957 14.42 92.1891 14.62C92.3891 14.82 92.6224 14.9733 92.8891 15.08C93.1557 15.1867 93.4457 15.24 93.7591 15.24ZM106.917 16.62C105.923 16.62 105.147 16.3433 104.587 15.79C104.027 15.2367 103.747 14.4467 103.747 13.42V9.5H105.367V13.36C105.367 14.0267 105.503 14.5067 105.777 14.8C106.05 15.0933 106.433 15.24 106.927 15.24C107.42 15.24 107.803 15.0933 108.077 14.8C108.35 14.5067 108.487 14.0267 108.487 13.36V9.5H110.087V13.42C110.087 14.4467 109.807 15.2367 109.247 15.79C108.687 16.3433 107.91 16.62 106.917 16.62ZM116.687 16.5V9.5H119.717C120.344 9.5 120.884 9.60333 121.337 9.81C121.791 10.01 122.141 10.3 122.387 10.68C122.634 11.06 122.757 11.5133 122.757 12.04C122.757 12.56 122.634 13.01 122.387 13.39C122.141 13.7633 121.791 14.05 121.337 14.25C120.884 14.45 120.344 14.55 119.717 14.55H117.587L118.307 13.84V16.5H116.687ZM121.137 16.5L119.387 13.96H121.117L122.887 16.5H121.137ZM118.307 14.02L117.587 13.26H119.627C120.127 13.26 120.501 13.1533 120.747 12.94C120.994 12.72 121.117 12.42 121.117 12.04C121.117 11.6533 120.994 11.3533 120.747 11.14C120.501 10.9267 120.127 10.82 119.627 10.82H117.587L118.307 10.05V14.02ZM131.341 16.62C130.781 16.62 130.244 16.5467 129.731 16.4C129.218 16.2467 128.804 16.05 128.491 15.81L129.041 14.59C129.341 14.8033 129.694 14.98 130.101 15.12C130.514 15.2533 130.931 15.32 131.351 15.32C131.671 15.32 131.928 15.29 132.121 15.23C132.321 15.1633 132.468 15.0733 132.561 14.96C132.654 14.8467 132.701 14.7167 132.701 14.57C132.701 14.3833 132.628 14.2367 132.481 14.13C132.334 14.0167 132.141 13.9267 131.901 13.86C131.661 13.7867 131.394 13.72 131.101 13.66C130.814 13.5933 130.524 13.5133 130.231 13.42C129.944 13.3267 129.681 13.2067 129.441 13.06C129.201 12.9133 129.004 12.72 128.851 12.48C128.704 12.24 128.631 11.9333 128.631 11.56C128.631 11.16 128.738 10.7967 128.951 10.47C129.171 10.1367 129.498 9.87333 129.931 9.68C130.371 9.48 130.921 9.38 131.581 9.38C132.021 9.38 132.454 9.43333 132.881 9.54C133.308 9.64 133.684 9.79333 134.011 10L133.511 11.23C133.184 11.0433 132.858 10.9067 132.531 10.82C132.204 10.7267 131.884 10.68 131.571 10.68C131.258 10.68 131.001 10.7167 130.801 10.79C130.601 10.8633 130.458 10.96 130.371 11.08C130.284 11.1933 130.241 11.3267 130.241 11.48C130.241 11.66 130.314 11.8067 130.461 11.92C130.608 12.0267 130.801 12.1133 131.041 12.18C131.281 12.2467 131.544 12.3133 131.831 12.38C132.124 12.4467 132.414 12.5233 132.701 12.61C132.994 12.6967 133.261 12.8133 133.501 12.96C133.741 13.1067 133.934 13.3 134.081 13.54C134.234 13.78 134.311 14.0833 134.311 14.45C134.311 14.8433 134.201 15.2033 133.981 15.53C133.761 15.8567 133.431 16.12 132.991 16.32C132.558 16.52 132.008 16.62 131.341 16.62ZM141.908 12.32H145.278V13.58H141.908V12.32ZM142.028 15.2H145.838V16.5H140.418V9.5H145.708V10.8H142.028V15.2ZM156.927 9.5H158.547V16.5H156.927V9.5ZM153.747 16.5H152.127V9.5H153.747V16.5ZM157.047 13.63H153.627V12.26H157.047V13.63ZM168.313 16.62C167.32 16.62 166.543 16.3433 165.983 15.79C165.423 15.2367 165.143 14.4467 165.143 13.42V9.5H166.763V13.36C166.763 14.0267 166.9 14.5067 167.173 14.8C167.446 15.0933 167.83 15.24 168.323 15.24C168.816 15.24 169.2 15.0933 169.473 14.8C169.746 14.5067 169.883 14.0267 169.883 13.36V9.5H171.483V13.42C171.483 14.4467 171.203 15.2367 170.643 15.79C170.083 16.3433 169.306 16.62 168.313 16.62ZM178.084 16.5V9.5H181.504C182.384 9.5 183.044 9.66667 183.484 10C183.931 10.3333 184.154 10.7733 184.154 11.32C184.154 11.6867 184.064 12.0067 183.884 12.28C183.704 12.5467 183.457 12.7533 183.144 12.9C182.831 13.0467 182.471 13.12 182.064 13.12L182.254 12.71C182.694 12.71 183.084 12.7833 183.424 12.93C183.764 13.07 184.027 13.28 184.214 13.56C184.407 13.84 184.504 14.1833 184.504 14.59C184.504 15.19 184.267 15.66 183.794 16C183.321 16.3333 182.624 16.5 181.704 16.5H178.084ZM179.694 15.28H181.584C182.004 15.28 182.321 15.2133 182.534 15.08C182.754 14.94 182.864 14.72 182.864 14.42C182.864 14.1267 182.754 13.91 182.534 13.77C182.321 13.6233 182.004 13.55 181.584 13.55H179.574V12.37H181.304C181.697 12.37 181.997 12.3033 182.204 12.17C182.417 12.03 182.524 11.82 182.524 11.54C182.524 11.2667 182.417 11.0633 182.204 10.93C181.997 10.79 181.697 10.72 181.304 10.72H179.694V15.28Z" fill="#FAF4E4"/>
        <defs>
        <clipPath id="clip0_7_85">
        <rect width="46" height="25" fill="white"/>
        </clipPath>
        </defs>
        </svg>
    </div>

    <div className="sidebar-container"> 
      {isAuthenticated ? (
          <>
          <nav className="menu">
            {menuItems.map(({ path, label, icon }) => (
              <Link
                key={path}
                to={path}
                className={`menu-item ${location.pathname === path ? "active" : ""}`}
              >
                <span className="icon">{icon}</span>
                <span className="label">{label}</span>
              </Link>
            ))}
          </nav>

          <button className="logout" onClick={handleLogout}>↪ Вийти</button>
          </>
      ) : (
        <>
          <nav className="menu">
            <Link
                to="/"
                className={`menu-item active`}
              >
                <span className="icon">{"🏵️" }</span>
                <span className="label">{"Головна"}</span>
              </Link>
          </nav>
          <button className="logout" onClick={() => navigate("/login")}>↪ Увійти</button>
          </>
          )}
    </div>
    </nav>
  );
};

export default SidebarMenu;
